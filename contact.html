<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Book Appointment - Skinship Beauty</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-pink: #e83e8c;
      --secondary-pink: #ff69b4;
      --light-pink: #fff0f6;
      --dark-pink: #c2185b;
      --text-color: #4a2c3a;
      --white: #ffffff;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      color: var(--text-color); 
      background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
      margin: 0; 
      padding: 20px;
      min-height: 100vh;
    }
    
    .container { 
      max-width: 900px; 
      margin: 20px auto; 
      background: var(--white); 
      border-radius: 15px; 
      box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
      padding: 40px 30px; 
    }
    
    .back-btn {
      display: inline-block;
      margin-bottom: 20px;
      padding: 10px 20px;
      background: var(--primary-pink);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 600;
    }
    
    .back-btn:hover {
      background: var(--dark-pink);
      transform: translateY(-2px);
    }
    
    .section-title h2 { 
      color: var(--dark-pink); 
      margin-bottom: 10px;
      font-size: 2rem;
    }
    
    .section-title p { 
      margin-bottom: 30px;
      color: #6b7280;
    }
    
    .user-info-card {
      background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      border: 2px solid var(--primary-pink);
    }
    
    .user-info-card h3 {
      color: var(--dark-pink);
      margin-bottom: 15px;
      font-size: 1.2rem;
    }
    
    .user-info-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      font-size: 1rem;
    }
    
    .user-info-item i {
      color: var(--primary-pink);
      margin-right: 10px;
      width: 20px;
    }
    
    .contact-form .form-group { 
      margin-bottom: 25px; 
    }
    
    .form-group label { 
      display: block; 
      margin-bottom: 8px; 
      font-weight: 600;
      font-size: 1.1rem;
      color: var(--dark-pink);
    }
    
    .form-group select, .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-family: inherit;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-group select:focus, .form-group textarea:focus {
      border-color: var(--primary-pink);
      outline: none;
      box-shadow: 0 0 0 3px rgba(232, 62, 140, 0.1);
    }
    
    .form-group textarea { 
      min-height: 100px;
      resize: vertical;
    }
    
    /* Service Selection */
    .service-selection {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
    }
    
    .service-selection:hover {
      border-color: var(--primary-pink);
    }
    
    .service-selection-placeholder {
      color: #9ca3af;
    }
    
    .service-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 2px solid var(--primary-pink);
      border-top: none;
      border-radius: 0 0 8px 8px;
      max-height: 300px;
      overflow-y: auto;
      display: none;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      margin-top: -2px;
    }
    
    .service-dropdown.show {
      display: block;
    }
    
    .service-category {
      font-weight: 700;
      padding: 12px 15px;
      background: var(--light-pink);
      color: var(--dark-pink);
      border-top: 1px solid #fce7f3;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .service-category:first-child {
      border-top: none;
    }
    
    .service-option {
      padding: 12px 20px;
      cursor: pointer;
      transition: all 0.2s;
      border-left: 3px solid transparent;
    }
    
    .service-option:hover {
      background: var(--light-pink);
      padding-left: 25px;
    }
    
    .service-option.selected {
      background: #fef3c7;
      border-left-color: var(--primary-pink);
      font-weight: 600;
      color: var(--dark-pink);
    }
    
    .selected-services {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }
    
    .service-tag {
      background: var(--primary-pink);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }
    
    .service-tag .remove {
      cursor: pointer;
      font-weight: bold;
      font-size: 1.2rem;
      line-height: 1;
    }
    
    /* Calendar Styles */
    .calendar-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 15px;
    }
    
    .calendar-section {
      background: #f9fafb;
      padding: 20px;
      border-radius: 10px;
      border: 2px solid #e5e7eb;
    }
    
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .calendar-header h3 {
      font-size: 1.2rem;
      color: var(--dark-pink);
    }
    
    .calendar-nav {
      display: flex;
      gap: 5px;
    }
    
    .calendar-nav button {
      background: white;
      border: 1px solid #e5e7eb;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .calendar-nav button:hover {
      background: var(--light-pink);
      border-color: var(--primary-pink);
    }
    
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    
    .calendar-day-header {
      text-align: center;
      font-weight: 600;
      font-size: 0.8rem;
      color: #6b7280;
      padding: 8px 0;
    }
    
    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.2s;
      background: white;
      border: 1px solid #e5e7eb;
      position: relative;
    }
    
    .calendar-day:hover:not(.disabled):not(.empty) {
      background: var(--light-pink);
      border-color: var(--primary-pink);
    }
    
    .calendar-day.selected {
      background: var(--primary-pink);
      color: white;
      font-weight: 700;
      border-color: var(--primary-pink);
    }
    
    .calendar-day.disabled {
      color: #d1d5db;
      cursor: not-allowed;
      background: #f9fafb;
    }
    
    .calendar-day.empty {
      background: transparent;
      border: none;
      cursor: default;
    }
    
    .calendar-day-dots {
      display: flex;
      gap: 2px;
      margin-top: 2px;
    }
    
    .calendar-day-dot {
      width: 4px;
      height: 4px;
      border-radius: 50%;
    }
    
    .dot-morning { background: #fbbf24; }
    .dot-afternoon { background: #f472b6; }
    .dot-evening { background: #60a5fa; }
    
    /* Time Slots */
    .time-section h4 {
      font-size: 1rem;
      color: var(--dark-pink);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .time-legend {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      font-size: 0.85rem;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }
    
    .time-slots-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      max-height: 400px;
      overflow-y: auto;
      padding-right: 5px;
    }
    
    .time-slot {
      padding: 10px;
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
      border: 2px solid transparent;
    }
    
    .time-slot.morning { border-color: #fbbf24; }
    .time-slot.afternoon { border-color: #f472b6; }
    .time-slot.evening { border-color: #60a5fa; }
    
    .time-slot:hover:not(.disabled) {
      background: var(--light-pink);
      border-color: var(--primary-pink);
    }
    
    .time-slot.selected {
      background: var(--primary-pink);
      color: white;
      border-color: var(--primary-pink);
      font-weight: 600;
    }
    
    .time-slot.disabled {
      background: #f3f4f6;
      color: #9ca3af;
      cursor: not-allowed;
      border-color: #e5e7eb;
    }
    
    .selected-datetime {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      border-left: 4px solid #fbbf24;
    }
    
    .selected-datetime p {
      margin: 5px 0;
      font-weight: 600;
      color: #92400e;
    }
    
    .btn { 
      background: linear-gradient(135deg, var(--primary-pink), var(--secondary-pink));
      color: #fff; 
      border: none; 
      padding: 15px 40px; 
      border-radius: 10px; 
      font-size: 1.1rem; 
      cursor: pointer; 
      transition: all 0.3s;
      font-weight: 700;
      width: 100%;
      margin-top: 20px;
    }
    
    .btn:hover:not(:disabled) { 
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(232, 62, 140, 0.3);
    }
    
    .btn:disabled { 
      background: #9ca3af; 
      cursor: not-allowed;
      transform: none;
    }
    
    .no-selection {
      text-align: center;
      padding: 40px 20px;
      color: #6b7280;
      font-style: italic;
    }
    
    .time-slot-column {
      overflow-y: auto;
      max-height: 200px;
    }
    .time-slot {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      border: 2px solid transparent;
    }
    .time-slot.morning { border-color: #fbbf24; }
    .time-slot.afternoon { border-color: #f472b6; }
    .time-slot.evening { border-color: #60a5fa; }
    
    @media (max-width: 768px) {
      .calendar-container {
        grid-template-columns: 1fr;
      }
      
      .container {
        padding: 20px 15px;
        margin: 10px;
      }
      
      .time-slots-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .success-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    
    .success-modal-content {
      background: white;
      border-radius: 10px;
      padding: 20px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .success-modal-content h2 {
      margin-bottom: 15px;
      color: var(--primary-pink);
    }
    .success-modal-content p {
      margin-bottom: 20px;
    }
    .success-modal-content .btn {
      background: var(--primary-pink);
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      text-decoration: none;
      display: inline-block;
      transition: background 0.3s ease;
    }
    .success-modal-content .btn:hover {
      background: var(--dark-pink);
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-btn">
      <i class="fas fa-arrow-left"></i> Back to Home
    </a>
    
    <div class="section-title">
      <h2>Book Your Appointment</h2>
      <p>Fill in the details below to schedule your service</p>
    </div>
    
    <!-- User Info Card (Auto-filled) -->
    <div class="user-info-card">
      <h3><i class="fas fa-user-circle"></i> Your Information</h3>
      <div class="user-info-item">
        <i class="fas fa-user"></i>
        <span id="userName">Loading...</span>
      </div>
      <div class="user-info-item">
        <i class="fas fa-envelope"></i>
        <span id="userEmail">Loading...</span>
      </div>
      <div class="user-info-item">
        <i class="fas fa-phone"></i>
        <span id="userPhone">Loading...</span>
      </div>
    </div>
    
    <form class="contact-form" id="bookingForm">
      <!-- Service Selection -->
      <div class="form-group">
        <label for="service">Services Interested In</label>
        <select id="service" name="service" required>
        </select>
      </div>
      
      <!-- Staff Selection -->
      <div class="form-group">
        <label for="staff">
          <i class="fas fa-user-md"></i> Choose Staff
        </label>
        <select id="staff" name="staff" required>
          <option value="">Select a staff member</option>
          <option value="Staff 1">Staff 1</option>
          <option value="Staff 2">Staff 2</option>
          <option value="Staff 3">Staff 3</option>
        </select>
      </div>
      
      <!-- Date & Time Selection -->
      <div class="form-group">
        <label>
          <i class="fas fa-calendar-alt"></i> Choose Date & Time
        </label>
        
        <div class="calendar-container">
          <!-- Calendar -->
          <div class="calendar-section">
            <div class="calendar-header">
              <h3 id="calendarMonth">October 2025</h3>
              <div class="calendar-nav">
                <button type="button" id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                <button type="button" id="nextMonth"><i class="fas fa-chevron-right"></i></button>
              </div>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
          </div>
          
          <!-- Time Slots -->
          <div class="calendar-section">
            <div class="time-section">
              <h4><i class="fas fa-clock"></i> Available Time Slots</h4>
              <div class="time-legend">
                <div class="legend-item">
                  <div class="legend-dot dot-morning"></div>
                  <span>Morning</span>
                </div>
                <div class="legend-item">
                  <div class="legend-dot dot-afternoon"></div>
                  <span>Afternoon</span>
                </div>
                <div class="legend-item">
                  <div class="legend-dot dot-evening"></div>
                  <span>Evening</span>
                </div>
              </div>
              <div id="timeSlotsContainer">
                <div class="no-selection">
                  <i class="fas fa-calendar-check" style="font-size: 2rem; color: #d1d5db; margin-bottom: 10px;"></i>
                  <p>Please select a date to view available times</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div id="selectedDateTime" class="selected-datetime" style="display: none;">
          <p><i class="fas fa-calendar"></i> <strong>Date:</strong> <span id="displayDate"></span></p>
          <p><i class="fas fa-clock"></i> <strong>Time:</strong> <span id="displayTime"></span></p>
        </div>
      </div>
      
      <!-- Additional Notes -->
      <div class="form-group">
        <label for="message">
          <i class="fas fa-comment-alt"></i> Additional Notes (Optional)
        </label>
        <textarea id="message" placeholder="Any special requests or information we should know?" maxlength="100"></textarea>
      </div>
      
      <button type="submit" class="btn" id="submitBtn" disabled>
        <i class="fas fa-check-circle"></i> Confirm Appointment
      </button>
    </form>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  
  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyD2Yh7L4Wl9XRlOgxnzZyo8xxds6a02UJY",
      authDomain: "skinship-1ff4b.firebaseapp.com",
      projectId: "skinship-1ff4b",
      storageBucket: "skinship-1ff4b.appspot.com",
      messagingSenderId: "963752770497",
      appId: "1:963752770497:web:8911cc6a375acdbdcc8d40"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

// Check if user is logged in and has correct role
const session = sessionStorage.getItem('userSession');
if (!session) {
  alert('Please login to book an appointment');
  window.location.href = 'login.html';
}
const userSession = JSON.parse(session);

// Only allow customers to access booking page
if (userSession.role !== 'customer') {
  alert('Only registered customers can book appointments');
  window.location.href = userSession.role === 'staff' || userSession.role === 'admin' ? 'dashboard.html' : 'index.html';
}

    // Fetch user details from Firestore
    async function loadUserDetails() {
      try {
        const userDoc = await db.collection("users").doc(userSession.userId).get();
        if (userDoc.exists) {
          const userData = userDoc.data();
          
          // Build full name
          const firstName = userData.firstName || '';
          const middleInitial = userData.middleInitial ? userData.middleInitial + '.' : '';
          const lastName = userData.lastName || '';
          const fullName = `${firstName} ${middleInitial} ${lastName}`.trim();
          
          // Update display
          document.getElementById('userName').textContent = fullName || userSession.fullName || userSession.email || 'N/A';
          document.getElementById('userEmail').textContent = userData.email || userSession.email || 'N/A';
          document.getElementById('userPhone').textContent = userData.phoneNumber || userData.phone || 'N/A';
          
          // Update session with full info
          userSession.fullName = fullName;
          userSession.phone = userData.phoneNumber || userData.phone;
          sessionStorage.setItem('userSession', JSON.stringify(userSession));
        } else {
          // Fallback to session data
          document.getElementById('userName').textContent = userSession.fullName || userSession.email || 'N/A';
          document.getElementById('userEmail').textContent = userSession.email || 'N/A';
          document.getElementById('userPhone').textContent = userSession.phone || 'N/A';
        }
      } catch (error) {
        console.error("Error loading user details:", error);
        // Fallback to session data
        document.getElementById('userName').textContent = userSession.fullName || userSession.email || 'N/A';
        document.getElementById('userEmail').textContent = userSession.email || 'N/A';
        document.getElementById('userPhone').textContent = userSession.phone || 'N/A';
      }
    }

    // Load user details on page load
    loadUserDetails();

    // Global variables
    let selectedServicesArray = [];
    let selectedDate = null;
    let selectedTime = null;
    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();

    // Service Selection Logic
    const serviceSelect = document.getElementById('service');

    function setupServiceSelection() {
        serviceSelect.addEventListener('click', (event) => {
            const option = event.target;
            if (option.tagName === 'OPTION') {
                option.selected = !option.selected;
                event.preventDefault(); // Prevent dropdown from closing
            }
        });
    }

    setupServiceSelection();

    function updateSelectedServices() {
      if (selectedServicesArray.length === 0) {
        serviceSelect.innerHTML = '<span class="service-selection-placeholder">Select services...</span>';
        selectedServicesContainer.innerHTML = '';
      } else {
        serviceSelect.innerHTML = `<span>${selectedServicesArray.length} service(s) selected</span>`;
        
        selectedServicesContainer.innerHTML = selectedServicesArray.map(service => 
          `<div class="service-tag">
            ${service}
            <span class="remove" onclick="removeService('${service.replace(/'/g, "\\'")}')">×</span>
          </div>`
        ).join('');
      }
      checkFormComplete();
    }

    window.removeService = function(serviceName) {
      selectedServicesArray = selectedServicesArray.filter(s => s !== serviceName);
      
      const serviceOptions = document.querySelectorAll('.service-option');
      serviceOptions.forEach(option => {
        if (option.textContent.trim() === serviceName) {
          option.classList.remove('selected');
        }
      });
      
      updateSelectedServices();
    };

    window.toggleService = function(serviceName, element) {
        const serviceSelect = document.getElementById('service');
        const options = Array.from(serviceSelect.options);

        options.forEach(option => {
            if (option.value === serviceName) {
                option.selected = !option.selected;
            }
        });
    };

    // Calendar Functions
    function generateCalendar(month, year) {
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const daysInMonth = lastDay.getDate();
      const startingDayOfWeek = firstDay.getDay();
      
      const monthNames = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"];
      
      document.getElementById('calendarMonth').textContent = `${monthNames[month]} ${year}`;
      
      const calendarGrid = document.getElementById('calendarGrid');
      calendarGrid.innerHTML = '';
      
      // Day headers
      const dayHeaders = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
      dayHeaders.forEach(day => {
        const dayHeader = document.createElement('div');
        dayHeader.className = 'calendar-day-header';
        dayHeader.textContent = day;
        calendarGrid.appendChild(dayHeader);
      });
      
      // Empty cells before first day
      for (let i = 0; i < startingDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day empty';
        calendarGrid.appendChild(emptyDay);
      }
      
      // Days of month
      const today = new Date();
      today.setHours(0, 0, 0, 0);
      
      for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = document.createElement('div');
        const currentDate = new Date(year, month, day);
        
        dayElement.className = 'calendar-day';
        dayElement.textContent = day;
        
        // Disable past dates
        if (currentDate < today) {
          dayElement.classList.add('disabled');
        } else {
          // Add availability indicators
          const dots = document.createElement('div');
          dots.className = 'calendar-day-dots';
          dots.innerHTML = `
            <div class="calendar-day-dot dot-morning"></div>
            <div class="calendar-day-dot dot-afternoon"></div>
            <div class="calendar-day-dot dot-evening"></div>
          `;
          dayElement.appendChild(dots);
          
          dayElement.addEventListener('click', () => selectDate(day, month, year));
        }
        
        calendarGrid.appendChild(dayElement);
      }
    }

    function selectDate(day, month, year) {
      selectedDate = new Date(year, month, day);
      
      // Update selected state
      document.querySelectorAll('.calendar-day').forEach(el => el.classList.remove('selected'));
      event.target.classList.add('selected');
      
      // Load time slots
      loadTimeSlots(selectedDate);
      
      // Update display
      const dateStr = selectedDate.toLocaleDateString('en-US', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
      document.getElementById('displayDate').textContent = dateStr;
      
      checkFormComplete();
    }

    function loadTimeSlots(date) {
      const container = document.getElementById('timeSlotsContainer');
      container.innerHTML = ''; // Clear previous slots

      const timeSlots = {
        morning: [
          '10:00am', '10:30am', '11:00am', '11:30am'
        ],
        afternoon: [
          '12:00pm', '12:30pm', '1:00pm', '1:30pm', '2:00pm', '2:30pm', '3:00pm', '3:30pm', '4:00pm', '4:30pm'
        ],
        evening: [
          '5:00pm', '5:30pm', '6:00pm', '6:30pm'
        ]
      };

      const grid = document.createElement('div');
      grid.className = 'time-slots-grid';
      grid.style.display = 'grid';
      grid.style.gridTemplateColumns = 'repeat(3, 1fr)';

      Object.entries(timeSlots).forEach(([period, slots]) => {
        const column = document.createElement('div');
        column.className = `time-slot-column ${period}`;

        slots.forEach(slot => {
          const timeSlot = document.createElement('div');
          timeSlot.className = 'time-slot';
          timeSlot.textContent = slot;
          
          // Set background color based on period
          if (period === 'morning') {
              timeSlot.style.backgroundColor = '#fef9c3'; // Lighter Yellow
          } else if (period === 'afternoon') {
              timeSlot.style.backgroundColor = '#fde2e4'; // Lighter Pink
          } else if (period === 'evening') {
              timeSlot.style.backgroundColor = '#dbeafe'; // Lighter Blue
          }

          timeSlot.addEventListener('click', () => selectTime(slot));
          column.appendChild(timeSlot);
        });

        grid.appendChild(column);
      });

      container.appendChild(grid);
      checkFormComplete();
    }

    function selectTime(time) {
      selectedTime = time;
      
      // Update selected state
      document.querySelectorAll('.time-slot').forEach(el => el.classList.remove('selected'));
      event.target.classList.add('selected');
      
      // Update display
      document.getElementById('displayTime').textContent = time;
      
      checkFormComplete();
    }

    function checkFormComplete() {
      const serviceSelect = document.getElementById('service');
      const staffSelect = document.getElementById('staff');
      const submitBtn = document.getElementById('submitBtn');

      if (serviceSelect.value && staffSelect.value && selectedDate !== null && selectedTime !== null) {
        submitBtn.disabled = false;
      } else {
        submitBtn.disabled = true;
      }
    }

    // Initialize calendar
    generateCalendar(currentMonth, currentYear);

    // Event listeners for navigation
    document.getElementById('prevMonth').addEventListener('click', () => {
      if (currentMonth === 0) {
        currentMonth = 11;
        currentYear--;
      } else {
        currentMonth--;
      }
      generateCalendar(currentMonth, currentYear);
    });

    document.getElementById('nextMonth').addEventListener('click', () => {
      if (currentMonth === 11) {
        currentMonth = 0;
        currentYear++;
      } else {
        currentMonth++;
      }
      generateCalendar(currentMonth, currentYear);
    });

    async function loadServices() {
        const services = {
            "FLEEK EYELASH": [
                "EYELASH NATURAL (1 SIZE) P 499",
                "EYELASH NATURAL VOLUME P 599",
                "EYELASH DOLL EYE (2 SIZE) P 599",
                "EYELASH CAT EYE (3 SIZE) P 699",
                "WISPY NATURAL P 699",
                "WISPY VOLUME P 799",
                "EYELASH REMOVAL IN 100/ OUT 200",
                "LASH LIFT P499 WITH TINT P 599"
            ],
            "BROWMAZING": [
                "THREADING P 200",
                "SHAVING P 150",
                "BROWLAMINATION P 499 WITH TINT P 699",
                "BROWWAXING P 249"
            ],
            "WOKE UP LIKE THIS": [
                "MICROBLADING P 1,499 (2 SESSIONS)",
                "COMBI/OMBRE/COMBIBROWS P 2,499 (2 SESSIONS)",
                "TOP/ LOWER EYELINER P 1,999 (2 SESSIONS)",
                "KOREAN BBGLOW P 1,499 (PER SESSION)",
                "LIP TATTOO/ LIP PIGMENTATION P 2,999 (2 SESSIONS)"
            ],
            "EXPRESS OFFER (30 MINS.)": [
                "BACK MASSAGE P 399",
                "HEAD MASSAGE P 399",
                "FOOT MASSAGE P 399",
                "HAND MASSAGE P 399",
                "FOOT REFLEX P 499",
                "HAND REFLEX P 499",
                "HEAD MASSAGE + EAR CANDLING P 499",
                "EAR CANDLING P 199"
            ],
            "HAPPY NAILS": [
                "BASIC MANICURE P 120",
                "BASIC PEDICURE P 170",
                "FOOTSPA P 300",
                "HANDSPA P 300",
                "GEL REMOVAL IN 100 / OUT 200",
                "SOFT GEL REMOVAL IN 200 / OUT 300",
                "SOFTGEL NAIL EXTENSIONS P 1,700",
                "GEL MANICURE P 550",
                "GEL PEDICURE P 650",
                "FOOTSPA OR HANDSPA WITH WHITENING SCRUB P 400 WITH CALLUS REMOVAL P 450"
            ],
            "PROMO PACKAGES": [
                "PACKAGE 1: UV GEL MANICURE + BASIC PEDICURE + CLASSIC FOOTSPA P 850",
                "PACKAGE 2: UV GEL MANICURE + BASIC PEDICURE + DELUXE FOOTSPA P 900",
                "PACKAGE 3: UV GEL MANICURE + UV GEL PEDICURE + CLASSIC FOOTSPA P 1,300",
                "PACKAGE 4: UV GEL MANICURE + UV GEL PEDICURE + DELUXE FOOTSPA WITH WHITENING SCRUB P 1,400",
                "PACKAGE 5: CLASSIC FOOTSPA + BASIC PEDICURE + 30 MINS. FOOT MASSAGE P 750",
                "PACKAGE 6: DELUXE FOOTSPA WITH WHITENING SCRUB + BASIC PEDICURE + 30 MINS. FOOT MASSAGE P 800",
                "PACKAGE 7: NATURAL EYELASH OR LASH LIFT (ADD 100 FOR TINT) + UV GEL MANICURE P 950",
                "PACKAGE 8: FOOTSPA + UV GELPEDICURE P 850",
                "PACKAGE 9: FOOTSPA + BASIC PEDICURE + FOOT REFLEX P 850",
                "PACKAGE 10: FOOTSPA + UV GEL PEDICURE + FOOT MASSAGE P 1,150"
            ],
            "THERAPEUTIC HEAT": [
                "HAND PARAFFIN P 250",
                "FOOT PARAFFIN P 300",
                "HAND PARAFFIN + HANDSPA P 550",
                "FOOT PARAFFIN + FOOT SPA P 600",
                "HAND PARAFFIN + HAND MASSAGE P 550",
                "FOOT PARAFFIN + FOOT MASSAGE P 600"
            ],
            "WAX – OUT": [
                "UNDER ARM P 399 / P 499",
                "HALF LEGS P 499 / P 599",
                "FULL LEGS P 699 / P 799",
                "BRAZILLIAN P 999 / P 1,099",
                "UPPER/ LOWER LIP P 299 / P 399",
                "FULL FACE P 899 / P 999",
                "FULL ARMS P 599 / P 699"
            ],
            "ES-FACIALY FOR YOU": [
                "HYDRAFACIAL WITH COLLAGEN MASK P 899",
                "BLACK DOLL CARBON LASER P 1,999 (2 SESSIONS)",
                "BLACK DOLL CARBON LASER LAY – AWAY PROMO",
                "4+1 SESSIONS P 4,500 DOWN P 2,500 SUCCEEDING IS P 1,000",
                "9+1 SESSIONS P 9,000 DOWN P 3,000 SUCCEEDING IS P 1,000",
                "ADD 100 FOR PDT LIGHT OR COLLAGEN MASK",
                "HYDRAFACIAL + BLACK DOLL + EXILLIS/ HIFU P 3,399",
                "HYDRAFACIAL + BBGLOW + COLLAGEN PDT P 1,899",
                "BLACK DOLL + EXILLIS / HIFU + PDT P 2,499",
                "HYDRAFACIAL + BBGLOWBLUSH + PDT P 2,199"
            ],
            "FACE AND BODY CONTOURING": [
                "HIFU P 1,499 / PER SESSION",
                "EXILLISS P 1,499 / PER SESSION 30 MINS.",
                "EMSLIM P 2,000/ PER SESSION 30 MINS.",
                "CRYOLIPOLYSIS P 1,499/ SESSION /BODY AREA",
                "CRYOLIPOLYSIS P 999 / CHIN AREA",
                "SUPER TRIO COMBO P 3,499 1 SESSION EACH",
                "LAY-WAY PROMO P 7,499",
                "EXILLIS 6+1 SESSIONS",
                "EMSLIM 5+1 SESSIONS",
                "POWERCOMBO EXISLIM 3+3 SESSIONS"
            ],
            "LASER HAIR REMOVAL / WHITENING": [
                "DIODE LASER UNDERARM 1 SESSION P 899",
                "DIODE LASER BRAZILLIAN 1 SESSION P 1,999",
                "DIODE LASER FULL ARMS 1 SESSION P 1,499",
                "DIODE LASER LOWER/UPPER LEGS 1 SESSION P 1,999",
                "DIODE LASER UPPER LIP 1 SESSION P 599",
                "DIODE LASER LOWER LIP 1 SESSION P 899",
                "DIODE LASER BIKINI LINE 1 SESSION P 1,099",
                "DIODE LASER FULL FACE MALE 1 SESSION P 2,999",
                "DIODE LASER FULL FACE FEMALE 1 SESSION P 1,999",
                "ADD ON FOR WHITENING SCRUB P 200"
            ],
            "PICOSURE LASER TREATMENT": [
                "LIP P 999",
                "KNEE / NECK / ELBOW/ UNDERARM / FACE P 1,499",
                "2 SESSIONS PICO MELASMA P 4,000",
                "2 SESSIONS TATTOO REMOVAL OR BIRTH 1-3 INC. P 3,000",
                "PROMO 4+1 SESSIONS ANY PART P 4,000"
            ],
            "WARTS REMOVAL FRACTIONAL LASER": [
                "FACE / NECK P 1,999",
                "BACK P 2,999",
                "FACE / NECK / BACK P 5,499",
                "SKIN TAG BY AREA P 1,499",
                "CO2 FRACTIONAL LASER LAY-AWAY 3+2 SESSIONS P 7,997 DOWN P 3,999"
            ]
        };

        let servicesHTML = '<option value="">Select a service</option>';
        for (const [category, serviceList] of Object.entries(services)) {
            servicesHTML += `<optgroup label="${category}" style="color: var(--primary-pink);">`;
            serviceList.forEach(service => {
                servicesHTML += `<option value="${service}">${service}</option>`;
            });
            servicesHTML += '</optgroup>';
        }
        document.getElementById('service').innerHTML = servicesHTML;
    }

    loadServices();
    
    // Set character limit for additional notes
    const noteInput = document.getElementById('message');
    noteInput.setAttribute('maxlength', '200');

    function showSuccessModal() {
        const modal = document.createElement('div');
        modal.className = 'success-modal';
        modal.innerHTML = `
            <div class="success-modal-content">
                <h2>Successfully Appointed!</h2>
                <p>You will be redirected back to the homepage in <span id="countdown">10</span> seconds.</p>
                <p>An email confirmation has been sent to you.</p>
                <a href="index.html" class="btn">Go Back to Home</a>
            </div>
        `;
        document.body.appendChild(modal);

        let timeLeft = 10;
        const countdownElement = document.getElementById('countdown');

        const countdownInterval = setInterval(() => {
            timeLeft--;
            countdownElement.textContent = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(countdownInterval);
                window.location.href = 'index.html';
            }
        }, 1000);
    }

    document.querySelector(".contact-form").addEventListener("submit", (e) => {
        e.preventDefault();
        showSuccessModal();
    });
  </script>
</body>
</html>